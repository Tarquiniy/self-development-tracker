{% extends "admin/base_site.html" %}
{% load static %}
{% block title %}Медиабиблиотека — {{ site_title|default:"Admin" }}{% endblock %}

{% block content %}
<div class="pt-container">
  <h1 class="page-title">Медиабиблиотека</h1>

  {% if not files %}
    <p class="muted">Нет файлов в MEDIA_ROOT или MEDIA_ROOT не настроен. Проверьте настройки <code>MEDIA_ROOT</code> и <code>MEDIA_URL</code>.</p>
  {% endif %}

  <div class="media-grid">
    {% for f in files %}
      <div class="media-item" title="{{ f.relpath }}">
        <a href="{{ f.url }}" target="_blank" rel="noopener">
          {% if f.name|lower|endswith:".jpg" or f.name|lower|endswith:".jpeg" or f.name|lower|endswith:".png" or f.name|lower|endswith:".gif" %}
            <img src="{{ f.url }}" alt="{{ f.name }}" />
          {% else %}
            <div style="height:84px;display:flex;align-items:center;justify-content:center;font-size:12px;background:#fbfbfd;border-radius:6px;border:1px solid #eee;">
              {{ f.name|slice:":24" }}
            </div>
          {% endif %}
        </a>
        <div class="filename">{{ f.relpath }}</div>
      </div>
    {% endfor %}
  </div>
</div>

<style>
/* быстрые локальные стили — можно убрать, если уже есть admin-fixes.css */
.media-grid{display:flex;flex-wrap:wrap;gap:8px}
.media-item{width:140px;text-align:center}
.media-item img{width:100%;height:84px;object-fit:cover;border-radius:6px;border:1px solid #eee}
.filename{font-size:12px;color:#6b7280;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}
</style>
{% endblock %}
