{% extends "admin/base.html" %}
{% load static i18n admin_compat %}

{% block extrahead %}
  {{ block.super }}
  <link rel="stylesheet" href="{% static 'admin/css/main.css' %}">
  <link rel="stylesheet" href="{% static 'admin/admin-modern.css' %}">
  <script defer src="{% static 'admin/js/custom_admin.js' %}"></script>
  <script defer src="{% static 'admin/js/admin_dashboard.js' %}"></script>
{% endblock %}

{% block branding %}
  <a href="{% url 'admin:index' %}" class="flex items-center gap-3">
    <img src="{% static 'admin/img/logo.svg' %}" alt="PT" class="logo" />
    <div>
      <div class="text-lg font-semibold text-gray-900">Positive Theta</div>
      <div class="text-sm text-gray-500">Content & Growth Studio</div>
    </div>
  </a>
{% endblock %}

{% block nav-global %}
  {{ block.super }}
  <div class="pt-topbar">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between h-14">
      <div class="flex items-center gap-3">
        <button id="pt-toggle-sidebar" class="p-2 rounded-md hover:bg-gray-100 md:hidden">☰</button>
        <form action="{% url 'search' %}" method="get" class="hidden md:flex">
          <input name="q" class="border rounded-md px-3 py-1 text-sm" placeholder="Поиск..." />
        </form>
      </div>
      <div class="flex items-center gap-2">
        <a href="{% url 'admin:index' %}" class="pt-btn">Dashboard</a>
        <a href="{% admin_changelist_or_app_list 'blog' 'post' %}" class="pt-btn-primary">Quick create / Blog</a>
      </div>
    </div>
  </div>

  <script>
    // Минимальная логика управления сайдбаром и быстрым созданием.
    document.addEventListener('DOMContentLoaded', function () {
      try {
        var toggle = document.getElementById('pt-toggle-sidebar');
        if (toggle) {
          toggle.addEventListener('click', function () {
            document.body.classList.toggle('pt-sidebar-collapsed');
          });
        }
      } catch (e) {
        if (window.console) console.error('[pt-topbar] init error', e);
      }
    });
  </script>
{% endblock %}
