{# templates/admin/widgets/tiptap_widget.html #}
{% load static %}
{# Полностью локальный виджет TipTap для Django admin #}

<textarea
  name="{{ widget.name }}"
  id="{{ widget.attrs.id|default:'id_'|add:widget.name }}"
  {% for k,v in widget.attrs.items %}
    {% if k != 'id' %}
      {{ k }}="{{ v|escape }}"
    {% endif %}
  {% endfor %}
>{{ widget.value|default_if_none:''|escape }}</textarea>

<div class="admin-tiptap-widget"
     data-upload-url="{{ widget.attrs.data_upload_url|default:"/api/blog/media/upload/" }}"
     data-preview-token-url="{{ widget.attrs.data_preview_token_url|default:"/admin/posts/preview-token/" }}"
     data-editor="{{ widget.attrs.data_editor|default:"auto" }}"
     aria-hidden="false">
  <div class="tiptap-toolbar" role="toolbar" aria-label="Editor toolbar"></div>
  <div class="tiptap-editor" contenteditable="true" spellcheck="true"></div>
</div>

{# локальные статические файлы: сначала бандл TipTap, потом инициализатор и css #}
<link rel="stylesheet" href="{% static 'admin/css/tiptap_admin.css' %}">
<script src="{% static 'admin/vendor/tiptap/tiptap.bundle.min.js' %}"></script>
<script src="{% static 'admin/js/tiptap_admin_extra.js' %}"></script>
