{# templates/admin/widgets/tiptap_widget.html #}
{% load static %}
<div class="admin-tiptap-widget"
     data-upload-url="{{ widget.attrs.data_upload_url|default:'/admin/blog/upload-image/' }}">
  <textarea name="{{ widget.name }}" id="{{ widget.attrs.id }}" style="display:none;">{{ widget.value|default:"" }}</textarea>

  {# placeholding element; editor script will attach here #}
  <div class="tiptap-placeholder">
    <div class="tiptap-toolbar" aria-hidden="true"></div>
    <div class="tiptap-editor"></div>
  </div>
</div>

{# подключаем локальный модуль JS, который инициализирует TipTap (или fallback) #}
<script type="module" src="{% static 'admin/js/tiptap_admin_extra.js' %}"></script>

<style>
.admin-tiptap-widget .tiptap-toolbar {
  margin-bottom: 8px;
  display:flex; gap:6px; flex-wrap:wrap;
}
.admin-tiptap-widget .tiptap-toolbar button {
  padding:6px 8px; border-radius:6px; border:1px solid #ddd; background:#fff; cursor:pointer;
}
.admin-tiptap-widget .tiptap-editor, .admin-tiptap-widget .tiptap-fallback {
  min-height:300px; padding:8px; border-radius:6px; background:#fff; border:1px solid #e5e7eb;
}
</style>
