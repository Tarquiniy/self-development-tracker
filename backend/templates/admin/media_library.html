{# backend/templates/admin/media_library.html #}
{% extends "admin/base_site.html" %}
{% load static %}
{% block extrastyle %}
<link rel="stylesheet" href="{% static 'admin/admin-modern.css' %}">
{% endblock %}

{% block content %}
<div class="media-lib-wrap card" role="main">
  <h1>Медиа-библиотека</h1>

  <div class="media-top" style="margin-top:12px;">
    <input id="media-search" class="media-search" placeholder="Поиск по имени или заголовку..." />
    <div style="display:flex;gap:8px;">
      <button id="upload-open-btn" class="button-secondary small-btn">Загрузить</button>
      <button id="refresh-btn" class="button small-btn">Обновить</button>
    </div>
  </div>

  <div id="media-grid" class="media-grid" aria-live="polite" style="margin-top:12px;">
    {% for a in attachments %}
      <div class="media-item" data-id="{{ a.id }}" data-url="{{ a.url|default:'' }}" data-title="{{ a.title|default:'' }}" data-filename="{{ a.filename|default:'' }}">
        <div class="media-thumb">
          {% if a.url %}
            <img src="{{ a.url }}" alt="{{ a.title|default:a.filename }}">
          {% else %}
            <div style="padding:12px;color:#6b7280">{{ a.filename|default:"файл" }}</div>
          {% endif %}
        </div>
        <div>
          <div class="media-title">{{ a.title|default:a.filename }}</div>
          <div class="media-meta">
            <span>{{ a.uploaded_at|default:"" }}</span>
            <div>
              <button class="small-btn select-btn">Выбрать</button>
              {% if a.url %}
                <a href="{{ a.url }}" class="small-btn" target="_blank">Открыть</a>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    {% empty %}
      <div style="grid-column:1/-1;padding:18px;color:#6b7280">Файлов нет.</div>
    {% endfor %}
  </div>

  <input id="media-file-input" type="file" style="display:none" multiple />
</div>

<script src="{% static 'admin/media-library.js' %}"></script>
{% endblock %}
